\section{Дополнение записей}\label{RECORD.Pad}

Записи TLS перед установкой защиты могут дополняться незначащими байтами, 
маскируя тем самым длину пересылаемых фрагментов данных и затрудняя анализ 
трафика. Например, клиент и сервер могут скрывать отсутствие активности в 
прикладном протоколе, обмениваясь пустыми фрагментами, но дополняя их.

Реализации TLS могут самостоятельно выбирать политику дополнения, включая 
условия установки дополнения и число дополнительных нулей. Дополнение не 
является обязательным механизмом.

Дополнительные байты записываются в поле \code{zeros} структуры 
\code{TLSInnerPlaintext}. Дополнительные байты должны быть нулевыми.

Дополнение снимается после снятия защиты с \code{TLSInnerPlaintext}. 
Учитывается, что перед \code{zeros} размещено ненулевое поле \code{type}.
Байты \code{TLSInnerPlaintext} просматриваются от конца к началу. Нулевые байты 
отбрасываются до тех пор, пока не встретится ненулевой.
%
Если ненулевой байт не найден, то соединение должно быть разорвано с 
оповещением \token[ALERT.Err.um]{unexpected_message}.

Размер структуры \code{TLSInnerPlaintext} не должен превышать $2^{14}+1$ байт. 
Размер должен определяться с учетом дополнения.
%
Если максимальный размер \code{TLSInnerPlaintext} уменьшается, например, через 
расширение \token[HS.Ext.mfl]{max_fragment_length} (см. 
таблицу~\ref{Table.HS.Exts}), то ограничение на размер должно продолжать 
учитывать дополнение.

% diff: в [RFC8446] речь идет о расширении `record_size_limit` из [RFC8449]
